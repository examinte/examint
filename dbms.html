<pre>
	<h1>company database</h1><br>
CREATE DATABASE COMPANY;

USE COMPANY;

CREATE TABLE EMPLOYEE (
    SSN INT PRIMARY KEY,
    Name VARCHAR(100),
    Address VARCHAR(255),
    Sex CHAR(1),
    Salary DECIMAL(10, 2),
    SuperSSN INT,
    DNo INT
);

CREATE TABLE DEPARTMENT (
    DNo INT PRIMARY KEY,
    DName VARCHAR(100),
    MgrSSN INT,
    MgrStartDate DATE
);

CREATE TABLE DLOCATION (
    DNo INT,
    DLoc VARCHAR(100),
    PRIMARY KEY (DNo, DLoc)
);

CREATE TABLE PROJECT (
    PNo INT PRIMARY KEY,
    PName VARCHAR(100),
    PLocation VARCHAR(100),
    DNo INT
);

CREATE TABLE WORKS_ON (
    SSN INT,
    PNo INT,
    Hours INT,
    PRIMARY KEY (SSN, PNo)
);

SHOW TABLES;

-- -- Inserting sample data into EMPLOYEE table
INSERT INTO EMPLOYEE (SSN, Name, Address, Sex, Salary, SuperSSN, DNo) 
VALUES 
(123456789, 'John Scott', '123 Main St', 'M', 60000.00, 987654321, 1),
(234567890, 'Jane Doe', '456 Elm St', 'F', 55000.00, 987654321, 2),
(345678901, 'Mark Scott', '789 Oak St', 'M', 65000.00, 987654321, 1),
(456789012, 'Emily Johnson', '101 Cedar St', 'F', 70000.00, 987654321, 3);

-- -- Inserting sample data into DEPARTMENT table
INSERT INTO DEPARTMENT (DNo, DName, MgrSSN, MgrStartDate) 
VALUES 
(1, 'HR', 123456789, '2020-01-01'),
(2, 'IT', 234567890, '2019-05-15'),
(3, 'Accounts', 345678901, '2018-12-20');

-- -- Inserting sample data into DLOCATION table
INSERT INTO DLOCATION (DNo, DLoc) 
VALUES 
(1, 'Location1'),
(2, 'Location2'),
(3, 'Location3');

-- -- Inserting sample data into PROJECT table
INSERT INTO PROJECT (PNo, PName, PLocation, DNo) 
VALUES 
(1, 'Project1', 'Location1', 1),
(2, 'Project2', 'Location2', 2),
(3, 'Project3', 'Location3', 3);

-- Inserting sample data into WORKS_ON table
INSERT INTO WORKS_ON (SSN, PNo, Hours) 
VALUES 
(123456789, 1, 40),
(234567890, 2, 35),
(345678901, 3, 45),
(456789012, 1, 42);

<h1>salesman database</h1>

CREATE TABLE salesman(
    Salesman_ID INT PRIMARY KEY,
    Name CHAR(20) NOT NULL,
    City CHAR(10),
    Commission DECIMAL(10, 2)
);

INSERT INTO salesman VALUES
(5000, 'James Bond', 'Bangalore', 0.17),
(5001, 'Adithi Sharma', 'Bangalore', 0.15),
(5002, 'Adithya Sharma', 'Puttur', 0.13),
(5003, 'Mukesh Ambani', '', 0.12),
(5005, 'Akash Sharma', 'Ladakh', 0.11),
(5006, 'Bharath Khanna', 'Puttur', 0.14),
(5007, 'Anil Ambani', 'Mangalore', 0.13);

SELECT * FROM salesman;
-- Customer Table:
CREATE TABLE customer(
    Customer_ID INTEGER PRIMARY KEY,
    Customer_Name CHAR(20) NOT NULL,
    City CHAR(10),
    Grade INTEGER,
    Salesman_ID INTEGER,

    CONSTRAINT salesman_id_customer_fk FOREIGN KEY(Salesman_ID)
    REFERENCES salesman(Salesman_ID) ON DELETE CASCADE
);
INSERT INTO customer VALUES
(3001, 'Raksha Sharma', 'Ladakh', NULL, 5005),
(3002, 'Nikhil Rao', 'Bangalore', 100, 5001),
(3003, 'John Cena', 'Mumbai', 200, 5007),
(3004, 'Nithesh Bhat', 'Puttur', 300, 5006),
(3005, 'Adarsh Shet', 'Calicut', 200, 5002),
(3006, 'Rakesh Chawla', 'Chennai', NULL, 5000),
(3007, 'Amar Deep', 'Bangalore', 200, 5001),
(3008, 'Yashas Bachan', 'Ladakh', 300, 5002),
(3009, 'Shreya Rao', 'Mysore', 100, 5003);

SELECT * FROM customer;
-- Orders Table:

CREATE TABLE orders(
    Order_No INTEGER PRIMARY KEY,
    Purchase_Amt DECIMAL(10,4),
    Order_Date DATE NOT NULL,
    Salesman_ID INTEGER NOT NULL,
    Customer_ID INTEGER NOT NULL,

    CONSTRAINT salesmanid_orders_fk FOREIGN KEY(Salesman_ID)
    REFERENCES salesman(Salesman_ID) ON DELETE CASCADE,

    CONSTRAINT customerid_orders_fk FOREIGN KEY(Customer_ID)
    REFERENCES customer(Customer_ID) ON DELETE CASCADE
);
INSERT INTO orders VALUES
(70001, 350.5000, '2012-10-01', 5002, 3005),
(70002, 65.2000, '2012-10-01', 5001, 3002),
(70003, 2400.4000, '2012-10-10', 5003, 3009),
(70004, 310.5000, '2012-08-17', 5002, 3008),
(70005, 2400.6000, '2012-07-27', 5001, 3007),
(70006, 2400.3500, '2012-07-20', 5000, 3006),
(70007, 5700.5000, '2012-05-10', 5001, 3002),
(70008, 270.4500, '2012-09-10', 5005, 3001),
(70010, 3503.4300, '2012-10-10', 5006, 3004),
(70011, 75.2000, '2012-10-17', 5007, 3003),
(70012, 250.4300, '2012-06-27', 5002, 3005),
(70013, 3045.0000, '2012-04-21', 5001, 3007);

SELECT * FROM orders;
show tables;
desc customer;
desc orders;
desc salesman;
-- Count thc customers with grades above Bangalore's average.

SELECT Grade,COUNT(Customer_ID) as Count
FROM customer
GROUP BY Grade
HAVING Grade > (
    SELECT AVG(Grade) 
    FROM customer
    WHERE city = "Bangalore"
);
-- Find the name and numbers of all salesman who had more than one customer.
SELECT Salesman_ID, Name 
FROM salesman
WHERE Salesman_ID IN (
    SELECT  Salesman_ID
    FROM customer
    GROUP BY Salesman_ID
    HAVING count(Customer_ID) > 1
);
-- List all the salesman and indicate those who have and don't have customers in their cities
SELECT S.Salesman_ID, S.Name, C.Customer_Name,
CASE
    WHEN S.City = C.City THEN "MATCH"
    ELSE "NOT MATCH"
END AS Same_City
FROM salesman S, customer C;

-- Create a view that finds the salesman who has thc customer with the highest order ofa day.
CREATE VIEW HIGHEST_ORDER_SALESMAN
AS SELECT O.Order_Date, S.Salesman_ID, S.Name
FROM salesman S, Orders O
WHERE S.Salesman_ID = O.Salesman_ID
    AND O.Purchase_Amt = (
        SELECT MAX(C.Purchase_Amt)
        FROM orders C
        WHERE C.Order_Date = O.Order_Date
);


SELECT * FROM highest_order_salesman;
DELETE
FROM salesman
WHERE Salesman_ID = 5001;
SELECT * FROM salesman;


<h1>Actor database</h1>


CREATE TABLE ACTOR
(Act_id INT PRIMARY KEY,
Act_name CHAR(20) NOT NULL,
Act_gender CHAR
);

SHOW TABLES;

INSERT INTO ACTOR VALUES
(101,'James Stewart','M'),
(102,'Deborah Kerr','F'),
(103,'Peter Otoole','M'),
(104,'Robert De Niro','M'),
(105,'F Murray Abraham','M'),
(106,'Harrison Ford','M'),
(107,'Nicole kidman','F'),
(108,'Stephan Baldwin','M'),
(109,'Jack Nicholson','M'),
(110,'Mark Nahloberg','M');

SHOW TABLES;

DESC ACTOR;

SELECT * FROM ACTOR;

CREATE TABLE DIRECTOR
(Dir_id INT PRIMARY KEY,
Dir_name VARCHAR(20) NOT NULL,
Dir_phone INT(12)
);

INSERT INTO DIRECTOR VALUES
(201,'Alfred Hitchcock',987654001),
(202,'Jack Clayton',987654002),
(203,'David Lean',987654003),
(204,'Michael Cimino',987654004),
(205,'Milos Forman',987654005),
(206,'Ridley Scott',987654006),
(207,'Stanley Kubrick',987654007),
(208,'Bryan Singer',987654008);

SELECT * FROM DIRECTOR;

CREATE TABLE MOVIES
(Mov_id INT PRIMARY KEY,
Mov_title VARCHAR(30),
Mov_year INT,
Mov_lang VARCHAR(10),
Dir_id INT,

CONSTRAINT dir_dirid_fk FOREIGN KEY(Dir_id) REFERENCES DIRECTOR(Dir_id)
);

INSERT INTO MOVIES VALUES
(901,'Vertigo',2000,'English',205),
(902,'The Innocents',1961,'English',204),
(903,'Lawrence of Arabia',1998,'English',203),
(904,'The Deer Hunter',2001,'English',202),
(905,'Amadeus',2002,'English',201),
(908,'The Usual Suspects',2010,'English',208),
(909,'Chinatown',2010,'English',207),
(910,'Boogie Nights',2015,'English',206),
(911,'Annie Hall',2016,'English',205),
(912,'Princess Mononoke',2017,'Japanese',204);
 
 SELECT * FROM MOVIES;

CREATE TABLE MOVIE_CAST
(Act_id INT,
Mov_id INT,
Role VARCHAR(20),
CONSTRAINT mc_actid_movid_pk PRIMARY KEY(Act_id,Mov_id),
CONSTRAINT mc_actid_fk FOREIGN KEY(Act_id) REFERENCES ACTOR(Act_id),
CONSTRAINT mc_movid_fk FOREIGN KEY(Mov_id) REFERENCES MOVIES(Mov_id)
);

INSERT INTO MOVIE_CAST VALUES
(101,901,'John Scottie Ferguso'),
(101,902,'Eilie Adams'),
(101,910,'Eddie Adams'),
(102,901,'Eddie Adams'),
(102,902,'Miss Giddens'),
(102,904,'Jack Paul'),
(103,903,'T.E Lawrence'),
(104,904,'Michael'),
(105,905,'Antonio Salieri'),
(105,910,'Smith'),
(108,908,'McManus'),
(109,911,'James Bond'),
(110,912,'Peter Park');

SELECT * FROM MOVIE_CAST;

CREATE TABLE RATING
(Mov_id INT,
Rev_stars INT,
CONSTRAINT r_movid_revstars_pk PRIMARY KEY(Mov_id,Rev_stars),
CONSTRAINT r_movid_fk FOREIGN KEY(Mov_id) REFERENCES MOVIES(Mov_id)
);

INSERT INTO RATING VALUES
(901,1),
(901,2),
(901,3),
(901,4),
(901,5),
(902,3),
(903,2),
(904,0),
(905,5),
(908,1),
(909,1),
(910,3);

SELECT * FROM RATING

SELECT Mov_Title
FROM MOVIES
WHERE Dir_id IN
(
    SELECT Dir_id
    FROM DIRECTOR
    WHERE Dir_name LIKE '%Hitchcock'
);

SELECT DISTINCT Mov_title 
 FROM MOVIES 
 WHERE Mov_id IN ( SELECT Mov_id 
FROM MOVIE_CAST 
WHERE Act_id IN ( SELECT Act_id 
 FROM MOVIE_CAST 
 GROUP BY Act_id 
 HAVING COUNT(Mov_id )>1));

SELECT  DISTINCT A.Act_name 
FROM    ACTOR A JOIN MOVIE_CAST C JOIN MOVIES M 
        ON A.Act_id =C.Act_id AND C.Mov_id= M.Mov_id
WHERE   M.Mov_year<2000 AND M.Mov_year>2015;

SELECT      MOVIES.Mov_title,RATING.Mov_id,SUM(RATING.Rev_stars) 
            AS Num_stars,MAX(Rev_stars) AS Max_star
FROM        MOVIES RIGHT OUTER JOIN RATING 
            ON MOVIES.Mov_id=RATING.Mov_id
GROUP BY    RATING.Mov_id ;


UPDATE RATING
SET Rev_stars = 5
WHERE Mov_id IN (
    SELECT Mov_id
    FROM movies
    WHERE Dir_id IN (
        SELECT Mov_id 
        FROM director
        WHERE Dir_name = 'Stanley Kubrick'
    )
);

SELECT * FROM RATING;


<h1>Student database</h1>



CREATE TABLE STUDENT
( Usn VARCHAR(20),
Sname VARCHAR(20) NOT NULL,
Address VARCHAR(20),
Phone INT UNIQUE,
Gender VARCHAR(2),
PRIMARY KEY(Usn) );

CREATE TABLE SEMSEC
( Ssid INT,
Sem VARCHAR(5),
Sec VARCHAR(10),
PRIMARY KEY(Ssid) );

CREATE TABLE CLASS
( Usn VARCHAR(20),
Ssid INT,
PRIMARY KEY(Usn,Ssid),
FOREIGN KEY(Usn) REFERENCES STUDENT(Usn),
CONSTRAINT
FOREIGN KEY(Ssid) REFERENCES SEMSEC(Ssid) );

CREATE TABLE SUBJECT
( Subcode VARCHAR(20),
Sub_title VARCHAR(30) NOT NULL,
Sem INT,
Credits INT,
PRIMARY KEY(Subcode) );

CREATE TABLE IAMARKS
(Usn VARCHAR(20),
Subcode VARCHAR(20),
Ssid INT,
Test1 INT,
Test2 INT,
Test3 INT,
Finalia FLOAT,
PRIMARY KEY(Usn,Subcode,Ssid),
FOREIGN KEY(Usn,Ssid) REFERENCES CLASS(Usn,Ssid),
FOREIGN KEY(Subcode) REFERENCES SUBJECT(Subcode) );

INSERT INTO STUDENT VALUES
("1BI16CS001",'Eddie Adams','Kartulla,Finland','987654012','M'),
('1BI16CS002','Alvy Singer','Osaka,Japan','987654013','F'),
('1BI16CS003','San','San Agelo,USA','987654014','F'),
('1BI16CS004','Andy Dufresne','Scotford,Canada','987654015','F'),
('1BI16CS005','Lester Burnham','Virrat,Finland','987654016','M'),
('1BI16CS006','Rose DeWitt Bukater','Nagoya,Japan','987654017','F'),
('1BI16CS007','Sean Maguire','Tervo,Finland','987654018','F'),
('4SN14CS001','Wilson Vinal','Calgary,Canada','987654037','M'),
('4SN14CS002','Maclin D','Ladmark,Australia','987654038','M'),
('4SN14CS003','Merlyn M','Winnipeg,Canada','987654039','F'),
('4SN14CS004','Natasha','Sabinas,USA','987654040','F'),
('4SN14CS005','Bunny','Calgary,Canada','987654027','M'),
('4SN14CS006','Bruce','Ladmark,Australia','987654028','M'),
('4SN14CS007','Jaisy K','Wiinipeg,Canada','987654029','F'),
('4SN14CS008','Fredie banks','Sabinas,USA','987654030','F'),
('4SN14CS009','Craig Octavia','Halsua,Finland','987654031','M'),
('4SN14CS010','Shreya Hegde','Surathkal,Mangalore','987654032','F'),
('4SN14CS011','Suraj Bhagya','Kodman,Udupi','987654033','M');

SELECT * FROM STUDENT;

INSERT INTO SEMSEC VALUES
('101','2','A'),
('102','2','B'),
('103','2','C'),
('201','4','A'),
('202','4','B'),
('203','4','C'),
('301','6','A'),
('302','6','B'),
('303','6','C'),
('401','8','A'),
('402','8','B'),
('403','8','C');

SELECT * FROM SEMSEC;

INSERT INTO CLASS VALUES
('1BI16CS001','201'),
('1BI16CS002','201'),
('1BI16CS003','201'),
('1BI16CS004','202'),
('1BI16CS005','202'),
('1BI16CS006','203'),
('1BI16CS007','203'),
('4SN14CS001','401'),
('4SN14CS002','401'),
('4SN14CS003','401'),
('4SN14CS004','401'),
('4SN14CS005','402'),
('4SN14CS006','402'),
('4SN14CS007','402'),
('4SN14CS008','402'),
('4SN14CS009','403'),
('4SN14CS010','403'),
('4SN14CS011','403');

SELECT * FROM CLASS;

INSERT INTO SUBJECT VALUES
('10CS21','C Programming','2','4'),
('10CS82','System Modeling and Design','8','4'),
('10CS83','Storage Area Network','8','2');

SELECT * FROM SUBJECT;

INSERT INTO IAMARKS VALUES
('4SN14CS001','10CS82','401','11','4','5',NULL),
('4SN14CS001','10CS83','401','12','4','3',NULL),
('4SN14CS002','10CS82','401','11','2','5',NULL),
('4SN14CS002','10CS83','401','9','5','3',NULL),
('4SN14CS003','10CS82','401','11','12','5',NULL),
('4SN14CS003','10CS83','401','19','15','13',NULL),
('4SN14CS004','10CS82','401','10','15','15',NULL),
('4SN14CS004','10CS83','401','10','9','3',NULL),
('4SN14CS005','10CS82','402','19','15','15',NULL),
('4SN14CS005','10CS83','402','10','16','13',NULL),
('4SN14CS006','10CS82','402','16','5','19',NULL),
('4SN14CS006','10CS83','402','9','16','18',NULL),
('4SN14CS007','10CS82','402','19','15','13',NULL),
('4SN14CS007','10CS83','402','10','15','13',NULL),
('4SN14CS008','10CS82','402','9','12','17',NULL),
('4SN14CS008','10CS83','402','10','11','11',NULL),
('4SN14CS009','10CS82','403','14','16','17',NULL),
('4SN14CS009','10CS83','403','8','6','2',NULL),
('4SN14CS010','10CS82','403','14','12','3',NULL),
('4SN14CS010','10CS83','403','10','6','12',NULL),
('4SN14CS011','10CS82','403','14','12','1',NULL),
('4SN14CS011','10CS83','403','10','16','13',NULL);

SELECT * FROM IAMARKS;

SELECT  S.Usn, S.Sname 
FROM    STUDENT S,SEMSEC M,CLASS C 
WHERE   M.Sem=4 AND M.Sec='c' AND S.Usn=C.Usn AND C.Ssid=M.Ssid


SELECT  C.Ssid AS Room_No, M.Sec AS Sec,M.Sem AS SEMESTER, 
        SUM(CASE WHEN S.Gender = 'M' THEN 1 ELSE 0 END) AS Male, 
        SUM(CASE WHEN S.Gender = 'F' THEN 1 ELSE 0 END) AS Female 
FROM    CLASS C ,STUDENT S,SEMSEC M 
WHERE   S.Usn=C.Usn AND M.Ssid=C.Ssid GROUP BY C.Ssid;


CREATE VIEW Test_MARK AS 
SELECT Test1 
FROM IAMARKS 
WHERE Usn='4SN14CS001';

SELECT * FROM test_mark;

SELECT  I.Usn, I.Test1,I.Test2,I.Test3,I.Finalia,
        (CASE WHEN I.Finalia>=17 AND I.Finalia<=20 THEN 'Outstanding'
                WHEN I.Finalia>=12 AND I.Finalia<17 THEN 'Average' 
                WHEN I.Finalia<12 THEN 'Weak' 
                ELSE 'INVALID' 
            END) AS Grade 
FROM    IAMARKS I,CLASS C,SEMSEC S 
WHERE   I.Usn=C.Usn AND C.Ssid=S.Ssid AND S.Sem=8 AND S.Sec IN ('A','B','C');
</pre>